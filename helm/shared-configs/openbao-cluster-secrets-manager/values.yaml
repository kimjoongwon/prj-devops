# OpenBao Cluster Secrets Manager - 클러스터 레벨 시크릿 관리
# 모든 환경(staging, production)에서 동일한 설정 사용

# OpenBao 서버 설정
openbao:
  server: "https://openbao.cocdev.co.kr"
  path: "secret"
  version: "v2"
  auth:
    tokenSecretRef:
      name: "openbao-token"
      key: "token"
  token:
    # 토큰 시크릿 생성 여부 (false: 스크립트로 수동 생성)
    # ./scripts/openbao/create-token.sh 스크립트로 Kubernetes Secret 생성
    create: false
    # 토큰 시크릿이 있는 네임스페이스
    namespace: "external-secrets"

# ClusterSecretStore 설정
clusterSecretStore:
  enabled: true
  name: "openbao-cluster-store"
  labels: {}
  annotations: {}

# 클러스터 레벨 시크릿 설정 (secret/server/cluster)
clusterSecrets:
  enabled: true
  name: "cluster-secrets"
  targetSecretName: "cluster-env-secrets"
  refreshInterval: "30m"
  remoteRef:
    key: "server/cluster"
  # 시크릿이 생성될 네임스페이스
  targetNamespaces:
    - plate-stg
    - plate-prod
  namespaceSelector:
    matchLabels: {}
  # dataFrom을 사용하여 OpenBao KV(server/cluster)의 모든 키-값을 자동으로 가져옴
  # 새 환경변수 추가 시 OpenBao KV에만 추가하면 자동 동기화됨
  # 개별 data 매핑이 더 이상 필요하지 않음
