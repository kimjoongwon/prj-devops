# Default values for openbao-secrets-manager
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Global configuration
global:
  # Target namespaces where secrets will be created
  namespaces:
    - plate-stg
    - plate-prod

# OpenBao configuration
openbao:
  # OpenBao server URL
  server: "https://openbao.cocdev.co.kr"
  # Secret engine path
  path: "secret"
  # API version
  version: "v2"
  # Authentication method
  auth:
    # Token secret reference
    tokenSecretRef:
      name: "openbao-token"
      key: "token"
  # OpenBao token management
  token:
    # Whether to create the token secret
    create: true
    # Token value (will be base64 encoded)
    value: "cy5laDdtazVONlgySG1OSE9jREkxRFJ0ajg="
    # Additional annotations for token secret
    annotations: {}

# External Secrets configuration
externalSecrets:
  # Install external-secrets operator as dependency
  install: false
  
  # SecretStore configuration
  secretStore:
    name: "openbao-env"
    labels: {}
    annotations: {}

  # ExternalSecret configuration
  externalSecret:
    name: "app-env-secrets"
    # Refresh interval for secret synchronization
    refreshInterval: "1h"
    # Target secret configuration
    target:
      name: "app-env-secrets"
      creationPolicy: "Owner"
      template:
        type: "Opaque"
        metadata:
          labels:
            app.kubernetes.io/component: "env-secrets"
        data: {}
    
    # Secret data mapping (will be overridden by environment-specific values)
    data:
      - secretKey: "APP_PORT"
        remoteRef:
          key: "server/default"  # Default path, should be overridden
          property: "APP_PORT"
      - secretKey: "APP_NAME"
        remoteRef:
          key: "server/default"
          property: "APP_NAME"
      - secretKey: "APP_ADMIN_EMAIL"
        remoteRef:
          key: "server/default"
          property: "APP_ADMIN_EMAIL"
      - secretKey: "API_PREFIX"
        remoteRef:
          key: "server/default"
          property: "API_PREFIX"
      - secretKey: "APP_FALLBACK_LANGUAGE"
        remoteRef:
          key: "server/default"
          property: "APP_FALLBACK_LANGUAGE"
      - secretKey: "APP_HEADER_LANGUAGE"
        remoteRef:
          key: "server/default"
          property: "APP_HEADER_LANGUAGE"
      - secretKey: "FRONTEND_DOMAIN"
        remoteRef:
          key: "server/default"
          property: "FRONTEND_DOMAIN"
      - secretKey: "BACKEND_DOMAIN"
        remoteRef:
          key: "server/default"
          property: "BACKEND_DOMAIN"
      - secretKey: "NODE_ENV"
        remoteRef:
          key: "server/default"
          property: "NODE_ENV"
      - secretKey: "AWS_ACCESS_KEY_ID"
        remoteRef:
          key: "server/default"
          property: "AWS_ACCESS_KEY_ID"
      - secretKey: "AWS_SECRET_ACCESS_KEY"
        remoteRef:
          key: "server/default"
          property: "AWS_SECRET_ACCESS_KEY"
      - secretKey: "AWS_REGION"
        remoteRef:
          key: "server/default"
          property: "AWS_REGION"
      - secretKey: "AWS_S3_BUCKET_NAME"
        remoteRef:
          key: "server/default"
          property: "AWS_S3_BUCKET_NAME"
      - secretKey: "SMTP_HOST"
        remoteRef:
          key: "server/default"
          property: "SMTP_HOST"
      - secretKey: "SMTP_PORT"
        remoteRef:
          key: "server/default"
          property: "SMTP_PORT"
      - secretKey: "SMTP_USERNAME"
        remoteRef:
          key: "server/default"
          property: "SMTP_USERNAME"
      - secretKey: "SMTP_PASSWORD"
        remoteRef:
          key: "server/default"
          property: "SMTP_PASSWORD"
      - secretKey: "SMTP_SENDER"
        remoteRef:
          key: "server/default"
          property: "SMTP_SENDER"
      - secretKey: "AUTH_JWT_SECRET"
        remoteRef:
          key: "server/default"
          property: "AUTH_JWT_SECRET"
      - secretKey: "AUTH_JWT_TOKEN_EXPIRES_IN"
        remoteRef:
          key: "server/default"
          property: "AUTH_JWT_TOKEN_EXPIRES_IN"
      - secretKey: "AUTH_JWT_TOKEN_REFRESH_IN"
        remoteRef:
          key: "server/default"
          property: "AUTH_JWT_TOKEN_REFRESH_IN"
      - secretKey: "AUTH_JWT_SALT_ROUNDS"
        remoteRef:
          key: "server/default"
          property: "AUTH_JWT_SALT_ROUNDS"
      - secretKey: "CORS_ENABLED"
        remoteRef:
          key: "server/default"
          property: "CORS_ENABLED"
      - secretKey: "DATABASE_URL"
        remoteRef:
          key: "server/default"
          property: "DATABASE_URL"
      - secretKey: "DIRECT_URL"
        remoteRef:
          key: "server/default"
          property: "DIRECT_URL"

# Environment-specific overrides
environments:
  staging:
    namespace: "plate-stg"
    remoteRef:
      key: "server/staging"
  production:
    namespace: "plate-prod"
    remoteRef:
      key: "server/production"

# Resource management
resources:
  limits:
    cpu: 100m
    memory: 128Mi
  requests:
    cpu: 10m
    memory: 64Mi

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1001
  fsGroup: 1001

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# ServiceAccount configuration
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Automatically mount a ServiceAccount's API credentials
  automountServiceAccountToken: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use
  name: ""

# Harbor registry authentication
harbor:
  # Enable Harbor registry secret creation
  enabled: true
  # External secret name for Harbor auth
  externalSecretName: "harbor-registry-secret"
  # Target secret name
  targetSecretName: "harbor-docker-secret"
  # Refresh interval
  refreshInterval: "1h"
  # Environment-specific configuration
  staging:
    remoteRef:
      key: "harbor/staging"
  production:
    remoteRef:
      key: "harbor/production"
  development:
    remoteRef:
      key: "harbor/development"
