# 공용 Ingress Chart Staging 값
# 목적: plate-stg 네임스페이스 서비스(frontend/backend)를 외부(stg 서브도메인)로 노출
# 차이점: HTTP 허용(ssl-redirect=false), TLS는 실서명(또는 스테이징) 인증서, 도메인 stg.cocdev.co.kr

# App name (default: plate)
appName: plate

# Service names (actual service names in the cluster)
services:                 # ArgoCD 릴리스명 기준 Service 오브젝트 이름 매핑
  frontend:
    name: "plate-web-stg"
    port: 80
  backend:
    name: "plate-server-stg"
    port: 80
  admin:
    name: "plate-admin-stg"
    port: 80

ingress:
  enabled: true
  name: "cocdev-ingress"
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"   # 필요 시 스테이징 ClusterIssuer 로 교체
    ingress.kubernetes.io/ssl-redirect: "false"          # Staging 은 HTTP 허용 (테스트 편의)
    acme.cert-manager.io/http01-edit-in-place: "true"
  hosts:
    - host: stg.cocdev.co.kr
      paths:
        # 전체 루트 -> 프론트엔드
        - path: /
          pathType: Prefix
          backend:
            service:
              name: frontend
              port:
                number: 80
        # /api prefix -> 백엔드 API
        - path: /api
          pathType: Prefix
          backend:
            service:
              name: backend
              port:
                number: 80
        # /admin prefix -> 관리자 페이지
        - path: /admin
          pathType: Prefix
          backend:
            service:
              name: plate-admin-stg
              port:
                number: 80
    - host: llm.cocdev.co.kr
      paths:
        # LLM 서비스 전체 경로
        - path: /
          pathType: Prefix
          backend:
            service:
              name: plate-llm-stg
              port:
                number: 80
  
  tls:
    - secretName: plate-stg-tls   # SAN 인증서: 모든 스테이징 도메인 포함
      hosts:
        - stg.cocdev.co.kr
        - llm.cocdev.co.kr